## From PowerShell Cookbook (O'Reilly)
## by Lee Holmes (http://www.leeholmes.com/guide)
##

Function Get-PrivateProfileSectionNames {
<#
.SYNOPSIS
    Describe purpose of "Get-PrivateProfileSectionNames" in 1-2 sentences.

.DESCRIPTION
    Add a more complete description of what the function does.

.PARAMETER file
    Describe parameter -file.

.EXAMPLE
    Get-PrivateProfileSectionNames -file Value
    Describe what this call does

.NOTES
    Place additional notes here.

.LINK
    URLs to related sites
    The first link is opened by Get-Help -Online Get-PrivateProfileSectionNames

.INPUTS
    List of input types that are accepted by this function.

.OUT    PUTS
    List of output types produced by this function.
#>


    ##############################################################################
    ##
    ## Get-PrivateProfileString.ps1
    ##
    ## Get an entry from an INI file.
    ##
    ## ie:
    ##
    ##  PS >Get-PrivateProfileString.ps1 C:\winnt\system32\ntfrsrep.ini text DEV_CTR_24_009_HELP
    ##
    ##############################################################################

    [cmdletbinding()]
    param(
        $file)

    ## Prepare the parameter types and parameter values for the Invoke-WindowsApi script
#    $returnValue = New-Object -typename System.Text.StringBuilder -Argumentlist 1000
#    $parameterTypes = [string[]], [int], [string]
#    $parameters = [string[]] $returnValue, [int] $returnValue.Capacity, [string] $file

    $returnValue = New-Object -typename System.Text.StringBuilder -Argumentlist 500
    $parameterTypes = [System.Text.StringBuilder], [int], [string]
    $parameters = [System.Text.StringBuilder] $returnValue, [int] $returnValue.Capacity, [string] $file

    ## Invoke the API
    $null =  (Invoke-WindowsApi -dllName 'kernel32.dll' -returnType ([UInt32]) -methodName 'GetPrivateProfileSectionNames'   -parameterTypes $parameterTypes -parameters $parameters)

    write-verbose -Message ($returnValue.gettype())
    $returnValue = $returnValue -replace "`0", "`n"
    ## And return the results
    write-output -inputobject $returnValue.ToString()

} #EndFunction Get-PrivateProfileString
